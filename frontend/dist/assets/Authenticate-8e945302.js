import{u as y,r as d,A as N,b as j,j as e}from"./index-fc747077.js";import{T as i,B as L,S as k}from"./Toast-b598388d.js";import{X as T,L as o}from"./svgs-0632f266.js";const S=()=>{const l=y(),{setAuthState:x}=d.useContext(N),[c,a]=d.useState(""),[m,u]=d.useState(!1),[P,p]=j();function g(s,n){u(!0),fetch("http://localhost:5000/login",{method:"POST",credentials:"include",mode:"cors",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:s,password:n})}).then(t=>{if(t.status===500){a("Server error");return}else if(t.status===406){a("Wrong password");return}else if(t.status===404){a("Email doesnt exist. Please register");return}return t.json()}).then(t=>{t&&t.user&&t.user._id&&(console.log(t),x(t.user),l("/"))}).catch(t=>{a("Some error occured"),console.error("Error while login",t)}).finally(()=>{u(!1)})}return e.jsxs("form",{className:"flex flex-col gap-4",onSubmit:s=>{var r,h;s.preventDefault();let n=(r=s.currentTarget.elements.email)==null?void 0:r.value,t=(h=s.currentTarget.elements.password)==null?void 0:h.value;if(t.length<5){a("please make atleast 5 letter password");return}if(n.length<3){a("please make atleast 5 letter password");return}g(n,t)},children:[e.jsx("h1",{className:"font-bold mx-auto text-xl",children:"Login"}),c.length>0&&e.jsxs("div",{className:"flex p-4 justify-between mb-4 text-sm text-red-800 rounded-lg bg-red-50 dark:bg-gray-800 dark:text-red-400",children:[e.jsx("span",{children:c}),e.jsx("button",{onClick:s=>{s.preventDefault(),a("")},children:e.jsx(T,{})})]}),e.jsxs("div",{children:[e.jsx("div",{className:"mb-2 block",children:e.jsx(o,{htmlFor:"email1",value:"Your email"})}),e.jsx(i,{id:"email1",type:"email",name:"email",minLength:3,maxLength:20,placeholder:"name@flowbite.com",required:!0})]}),e.jsxs("div",{children:[e.jsx("div",{className:"mb-2 block",children:e.jsx(o,{htmlFor:"password1",value:"Your password"})}),e.jsx(i,{id:"password1",minLength:5,maxLength:20,type:"password",name:"password",required:!0})]}),e.jsx(L,{type:"submit",disabled:m,children:e.jsxs("div",{className:"flex space-x-2 items-center",children:[m&&e.jsx(k,{}),e.jsx("div",{children:"Login"})]})}),e.jsxs("div",{className:"text-xs mt-5 mx-auto",children:["Don't have an account",e.jsx("button",{onClick:s=>{s.preventDefault(),p("register")},className:"text-blue-600 hover:underline mx-1 dark:text-blue-500",children:" Register "})]})]})},C=()=>{const l=y(),{setAuthState:x}=d.useContext(N),[c,a]=d.useState(""),[m,u]=d.useState(!1),[P,p]=j();function g(s,n,t){u(!0),fetch("http://localhost:5000/register",{method:"POST",credentials:"include",mode:"cors",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:s,password:n,name:t})}).then(r=>{if(r.status===500){a("Server error");return}else if(r.status===409){a("Email already exist. Please Login");return}return r.json()}).then(r=>{r&&r.user&&r.user._id&&(x(r.user),l("/"))}).catch(r=>{a("Some error occured"),console.error(r)}).finally(()=>{u(!1)})}return e.jsxs("form",{className:"flex flex-col gap-4",onSubmit:s=>{var f,b,v,w;s.preventDefault();let n=(f=s.currentTarget.elements.email)==null?void 0:f.value,t=(b=s.currentTarget.elements.password)==null?void 0:b.value,r=(v=s.currentTarget.elements.repeat)==null?void 0:v.value;if(!t.match(r)){a("password and repeat password not equal");return}if(t.length<5){a("password longer than 5");return}let h=(w=s.currentTarget.elements.name)==null?void 0:w.value;g(n,t,h)},children:[e.jsx("h1",{className:"font-bold mx-auto text-xl",children:"Register"}),c.length>0&&e.jsxs("div",{className:"flex p-4 justify-between mb-4 text-sm text-red-800 rounded-lg bg-red-50 dark:bg-gray-800 dark:text-red-400",children:[e.jsx("span",{children:c}),e.jsx("button",{onClick:s=>{s.preventDefault(),a("")},children:e.jsx(T,{})})]}),e.jsxs("div",{children:[e.jsx("div",{className:"mb-2 block",children:e.jsx(o,{htmlFor:"email2",value:"Your email"})}),e.jsx(i,{id:"email2",type:"email",maxLength:30,minLength:3,name:"email",placeholder:"name@flowbite.com",required:!0,shadow:!0})]}),e.jsxs("div",{children:[e.jsx("div",{className:"mb-2 block",children:e.jsx(o,{htmlFor:"password2",value:"Your password"})}),e.jsx(i,{id:"password2",type:"password",name:"password",maxLength:20,minLength:5,required:!0,shadow:!0})]}),e.jsxs("div",{children:[e.jsx("div",{className:"mb-2 block",children:e.jsx(o,{htmlFor:"repeat-password",value:"Repeat password"})}),e.jsx(i,{id:"repeat-password",type:"password",name:"repeat",maxLength:20,minLength:5,required:!0,shadow:!0})]}),e.jsxs("div",{children:[e.jsx("div",{className:"mb-2 block",children:e.jsx(o,{htmlFor:"name",value:"Your name"})}),e.jsx(i,{id:"name",name:"name",type:"text",maxLength:20,minLength:3,required:!0,shadow:!0})]}),e.jsx(L,{type:"submit",disabled:m,children:e.jsxs("div",{className:"flex space-x-2 items-center",children:[m&&e.jsx(k,{}),e.jsx("div",{children:"Register"})]})}),e.jsxs("div",{className:"text-xs mt-5 mx-auto",children:["Don't have an account",e.jsx("button",{onClick:s=>{s.preventDefault(),p("login")},className:"text-blue-600 hover:underline mx-1 dark:text-blue-500",children:" Login "})]})]})},R=()=>e.jsx("div",{className:"w-full",children:e.jsx("div",{className:"max-w-md mx-auto mt-10 border p-5 rounded-3xl shadow-xl",children:e.jsx(D,{})})}),D=()=>{const[l,x]=j();return l.has("verify-email")?e.jsx(S,{}):l.has("register")?e.jsx(C,{}):e.jsx(S,{})};export{R as default};
